(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-11134835"],{"0cac":function(t,e,n){"use strict";n("f883")},2423:function(t,e,n){"use strict";n.d(e,"f",(function(){return r})),n.d(e,"e",(function(){return c})),n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return s})),n.d(e,"b",(function(){return o})),n.d(e,"d",(function(){return u}));var a=n("b775"),r=function(t){return Object(a["a"])({method:"GET",url:"/app/v1_1/articles",params:t})},c=function(t){return Object(a["a"])({method:"GET",url:"/app/v1_0/articles/".concat(t)})},i=function(t){return Object(a["a"])({method:"POST",url:"/app/v1_0/article/collections",data:{target:t}})},s=function(t){return Object(a["a"])({method:"DELETE",url:"/app/v1_0/article/collections/".concat(t)})},o=function(t){return Object(a["a"])({method:"POST",url:"/app/v1_0/article/likings",data:{target:t}})},u=function(t){return Object(a["a"])({method:"DELETE",url:"/app/v1_0/article/likings/".concat(t)})}},"2a16":function(t,e,n){},"57de":function(t,e,n){"use strict";n("930b")},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,n){var a=n("1d80"),r=n("5899"),c="["+r+"]",i=RegExp("^"+c+c+"*"),s=RegExp(c+c+"*$"),o=function(t){return function(e){var n=String(a(e));return 1&t&&(n=n.replace(i,"")),2&t&&(n=n.replace(s,"")),n}};t.exports={start:o(1),end:o(2),trim:o(3)}},"7abe":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home-container"},[n("van-nav-bar",{scopedSlots:t._u([{key:"title",fn:function(){return[n("van-button",{staticClass:"search-btn",attrs:{round:"",icon:"search",size:"small",type:"info",to:"/search"}},[t._v("搜索")])]},proxy:!0}])}),n("van-tabs",{staticClass:"channel-tabs",scopedSlots:t._u([{key:"nav-right",fn:function(){return[n("div",{staticClass:"hiddenspace"}),n("div",{staticClass:"wap-nav-wrap",on:{click:function(e){t.isChannelEditShow=!0}}},[n("van-icon",{attrs:{name:"wap-nav"}})],1)]},proxy:!0}]),model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},t._l(t.channels,(function(t){return n("van-tab",{key:t.id,attrs:{title:t.name}},[n("article-list",{attrs:{channel:t}})],1)})),1),n("van-popup",{staticStyle:{height:"100%"},attrs:{"close-icon-position":"top-left",closeable:"",position:"top"},model:{value:t.isChannelEditShow,callback:function(e){t.isChannelEditShow=e},expression:"isChannelEditShow"}},[n("channel-edit",{attrs:{active:t.active,userChannels:t.channels},on:{"update-active":function(e){t.active=e},close:function(e){t.isChannelEditShow=!t.isChannelEditShow}}})],1)],1)},r=[],c=(n("96cf"),n("1da1")),i=n("5530"),s=n("c24f"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"article-list",staticClass:"article-list"},[n("van-pull-refresh",{attrs:{"success-text":t.refreshSuccessText,"success-duration":1500},on:{refresh:t.onRefresh},model:{value:t.isRefreshLoading,callback:function(e){t.isRefreshLoading=e},expression:"isRefreshLoading"}},[n("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.articles,(function(t,e){return n("article-item",{key:e,attrs:{article:t}})})),1)],1)],1)},u=[],l=n("2909"),d=n("2423"),f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("van-cell",{staticClass:"article-item",attrs:{to:{name:"article",params:{articleId:t.article.art_id}}},scopedSlots:t._u([{key:"title",fn:function(){return[n("div",{staticClass:"title van-multi-ellipsis--l3"},[t._v(" "+t._s(t.article.title)+" ")])]},proxy:!0},{key:"label",fn:function(){return[3===t.article.cover.type?n("div",{staticClass:"cover-wrap"},t._l(t.article.cover.images,(function(t,e){return n("div",{key:e,staticClass:"cover-wrap-item"},[n("van-image",{staticClass:"cover-item",attrs:{fit:"cover",src:t||"https://img01.yzcdn.cn/vant/cat.jpeg"}})],1)})),0):t._e(),n("div",{staticClass:"label-wrap"},[n("span",[t._v(t._s(t.article.aut_name))]),n("span",[t._v(t._s(t.article.comm_count)+"评论")]),n("span",[t._v(t._s(t._f("relativeTime")(t.article.pubdate)))])])]},proxy:!0}])},[1===t.article.cover.type?n("van-image",{staticClass:"right-cover",attrs:{fit:"cover",src:t.article.cover.images[0]?t.article.cover.images[0]:"https://img01.yzcdn.cn/vant/cat.jpeg"}}):t._e()],1)},h=[],p={props:{article:{type:Object,required:!0}}},v=p,m=(n("e69c"),n("2877")),b=Object(m["a"])(v,f,h,!1,null,"67fd4140",null),g=b.exports,_=n("a14a"),C={props:{channel:{type:Object,required:!0}},data:function(){return{articles:[],loading:!1,finished:!1,timestamp:null,isRefreshLoading:!1,refreshSuccessText:"",scrollTop:0}},components:{ArticleItem:g},methods:{onLoad:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var n,a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(d["f"])({channel_id:t.channel.id,timestamp:t.timestamp||Date.now(),with_top:1});case 2:a=e.sent,r=a.data,(n=t.articles).push.apply(n,Object(l["a"])(r.data.results)),t.loading=!1,r.data.results.length?t.timestamp=r.data.pre_timestamp:t.finished=!0;case 7:case"end":return e.stop()}}),e)})))()},onRefresh:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var n,a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(d["f"])({channel_id:t.channel.id,timestamp:Date.now(),with_top:1});case 2:a=e.sent,r=a.data,(n=t.articles).unshift.apply(n,Object(l["a"])(r.data.results)),t.isRefreshLoading=!1,t.refreshSuccessText="更新了".concat(r.data.results.length,"条数据！");case 7:case"end":return e.stop()}}),e)})))()}},mounted:function(){var t=this,e=this.$refs["article-list"];e.onscroll=Object(_["debounce"])((function(){t.scrollTop=e.scrollTop}),50)},activated:function(){this.$refs["article-list"].scrollTop=this.scrollTop}},E=C,O=(n("958e"),Object(m["a"])(E,o,u,!1,null,"1bd1f6d8",null)),w=O.exports,x=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"channel-edit"},[n("van-nav-bar",{attrs:{title:"频道编辑"}}),n("van-cell",{attrs:{center:"",border:!1},scopedSlots:t._u([{key:"title",fn:function(){return[n("span",{staticClass:"channel-title"},[t._v("我的频道")]),n("span",{staticClass:"channel-tip"},[t._v("点击进入频道")])]},proxy:!0}])},[n("van-button",{staticStyle:{"min-width":"'50px'"},attrs:{size:"mini",round:"",plain:"",type:"danger"},on:{click:function(e){t.isEdit=!t.isEdit}}},[t._v(" "+t._s(t.isEdit?"完成":"编辑")+" ")])],1),n("van-grid",{attrs:{gutter:10}},t._l(t.userChannels,(function(e,a){return n("van-grid-item",{key:a,staticClass:"gird-item",class:{active:a===t.active},attrs:{text:e.name},on:{click:function(e){return t.switchChannel(a)}},scopedSlots:t._u([{key:"icon",fn:function(){return[t.isEdit&&0!==a?n("van-icon",{attrs:{name:"close"},on:{click:function(n){return t.deleteChannel(e,a)}}}):t._e()]},proxy:!0}],null,!0)})})),1),n("van-cell",{attrs:{center:"",border:!1},scopedSlots:t._u([{key:"title",fn:function(){return[n("span",{staticClass:"channel-title"},[t._v("频道推荐")]),n("span",{staticClass:"channel-tip"},[t._v("点击添加频道")])]},proxy:!0}])}),n("van-grid",{attrs:{gutter:10}},t._l(t.recommendChannels,(function(e,a){return n("van-grid-item",{key:a+"all",staticClass:"gird-item",attrs:{text:e.name},on:{click:function(n){return t.onAdd(e)}}})})),1)],1)},j=[],k=(n("4de4"),n("7db0"),n("a434"),n("a9e3"),n("2f62")),y=n("5d2d"),T=n("b775"),S=function(){return Object(T["a"])({method:"GET",url:"/app/v1_0/channels"})},A=function(t){return Object(T["a"])({method:"PATCH",url:"/app/v1_0/user/channels",data:t})},R=function(t){return Object(T["a"])({method:"DELETE",url:"/app/v1_0/user/channels/".concat(t)})},I={props:{userChannels:{type:Array,required:!0},active:{type:Number,required:!0}},data:function(){return{allChannels:[],isEdit:!1}},computed:Object(i["a"])({recommendChannels:function(){var t=this;return this.allChannels.filter((function(e){return!t.userChannels.find((function(t){return t.id===e.id}))}))}},Object(k["b"])(["user"])),methods:{loadAllChannels:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,S();case 2:n=e.sent,a=n.data,console.log(a),t.allChannels=a.data.channels;case 6:case"end":return e.stop()}}),e)})))()},onAdd:function(t){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.userChannels.push(t),!e.user){n.next=6;break}return n.next=4,A({channels:[{id:t.id,seq:e.userChannels.length}]});case 4:n.next=7;break;case 6:Object(y["b"])("user-channels",e.userChannels);case 7:case"end":return n.stop()}}),n)})))()},deleteChannel:function(t,e){var n=this;return Object(c["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e<=n.active&&n.$emit("update-active",n.active-1),n.userChannels.splice(e,1),!n.user){a.next=8;break}return console.log("删除频道"),a.next=6,R(t.id);case 6:a.next=9;break;case 8:Object(y["b"])("user-channels",n.userChannels);case 9:case"end":return a.stop()}}),a)})))()},switchChannel:function(t){this.isEdit||(console.log("切换频道"),this.$emit("update-active",t),this.$emit("close",t))}},created:function(){this.loadAllChannels()}},N=I,L=(n("57de"),Object(m["a"])(N,x,j,!1,null,"26a28252",null)),G=L.exports,$={data:function(){return{active:0,channels:[],isChannelEditShow:!1}},computed:Object(i["a"])({},Object(k["b"])(["user"])),components:{ArticleList:w,ChannelEdit:G},methods:{loadChannels:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var n,a,r,c,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.user){e.next=8;break}return e.next=3,Object(s["d"])();case 3:n=e.sent,a=n.data,t.channels=a.data.channels,e.next=18;break;case 8:if(r=Object(y["a"])("user-channels"),!r){e.next=13;break}t.channels=r,e.next=18;break;case 13:return e.next=15,Object(s["d"])();case 15:c=e.sent,i=c.data,t.channels=i.data.channels;case 18:case"end":return e.stop()}}),e)})))()}},created:function(){this.loadChannels()},watch:{user:function(){this.active=0,this.loadChannels()}}},P=$,D=(n("0cac"),Object(m["a"])(P,a,r,!1,null,"72a6f9f0",null));e["default"]=D.exports},"7db0":function(t,e,n){"use strict";var a=n("23e7"),r=n("b727").find,c=n("44d2"),i=n("ae40"),s="find",o=!0,u=i(s);s in[]&&Array(1)[s]((function(){o=!1})),a({target:"Array",proto:!0,forced:o||!u},{find:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),c(s)},"930b":function(t,e,n){},"958e":function(t,e,n){"use strict";n("2a16")},a9e3:function(t,e,n){"use strict";var a=n("83ab"),r=n("da84"),c=n("94ca"),i=n("6eeb"),s=n("5135"),o=n("c6b6"),u=n("7156"),l=n("c04e"),d=n("d039"),f=n("7c73"),h=n("241c").f,p=n("06cf").f,v=n("9bf2").f,m=n("58a8").trim,b="Number",g=r[b],_=g.prototype,C=o(f(_))==b,E=function(t){var e,n,a,r,c,i,s,o,u=l(t,!1);if("string"==typeof u&&u.length>2)if(u=m(u),e=u.charCodeAt(0),43===e||45===e){if(n=u.charCodeAt(2),88===n||120===n)return NaN}else if(48===e){switch(u.charCodeAt(1)){case 66:case 98:a=2,r=49;break;case 79:case 111:a=8,r=55;break;default:return+u}for(c=u.slice(2),i=c.length,s=0;s<i;s++)if(o=c.charCodeAt(s),o<48||o>r)return NaN;return parseInt(c,a)}return+u};if(c(b,!g(" 0o1")||!g("0b1")||g("+0x1"))){for(var O,w=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof w&&(C?d((function(){_.valueOf.call(n)})):o(n)!=b)?u(new g(E(e)),n,w):E(e)},x=a?h(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),j=0;x.length>j;j++)s(g,O=x[j])&&!s(w,O)&&v(w,O,p(g,O));w.prototype=_,_.constructor=w,i(r,b,w)}},c24f:function(t,e,n){"use strict";n.d(e,"f",(function(){return r})),n.d(e,"g",(function(){return c})),n.d(e,"c",(function(){return i})),n.d(e,"d",(function(){return s})),n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return u})),n.d(e,"e",(function(){return l})),n.d(e,"i",(function(){return d})),n.d(e,"h",(function(){return f}));var a=n("b775"),r=function(t){return Object(a["a"])({method:"post",url:"/app/v1_0/authorizations",data:t})},c=function(t){return Object(a["a"])({method:"GET",url:"/app/v1_0/sms/codes/".concat(t)})},i=function(){return Object(a["a"])({method:"GET",url:"/app/v1_0/user"})},s=function(){return Object(a["a"])({method:"GET",url:"/app/v1_0/user/channels"})},o=function(t){return Object(a["a"])({method:"POST",url:"/app/v1_0/user/followings",data:{target:t}})},u=function(t){return Object(a["a"])({method:"DELETE",url:"/app/v1_0/user/followings/".concat(t)})},l=function(){return Object(a["a"])({method:"GET",url:"/app/v1_0/user/profile"})},d=function(t){return Object(a["a"])({method:"PATCH",url:"/app/v1_0/user/profile",data:t})},f=function(t){return Object(a["a"])({method:"PATCH",url:"/app/v1_0/user/photo",data:t})}},d9b4:function(t,e,n){},e69c:function(t,e,n){"use strict";n("d9b4")},f883:function(t,e,n){}}]);
//# sourceMappingURL=chunk-11134835.84abe632.js.map